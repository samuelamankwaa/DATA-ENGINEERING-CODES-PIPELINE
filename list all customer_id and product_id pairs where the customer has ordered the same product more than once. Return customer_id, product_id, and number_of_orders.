SELECT 
    o.customer_id,
    od.product_id,
    COUNT(*) AS number_of_orders
FROM orders_amz o
JOIN orderdetails od ON o.order_id = od.order_id
GROUP BY o.customer_id, od.product_id
HAVING COUNT(*) > 1
ORDER BY number_of_orders DESC;
