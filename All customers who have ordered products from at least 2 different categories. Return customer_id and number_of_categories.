SELECT
    customer_id,
    number_of_categories
FROM (
    SELECT
        o.customer_id,
        COUNT(DISTINCT p.category) AS number_of_categories
    FROM
        orders_amz o
    JOIN
        orderdetails od ON o.order_id = od.order_id
    JOIN
        products_amz p ON od.product_id = p.product_id
    GROUP BY
        o.customer_id
) t
WHERE
    number_of_categories >= 2
ORDER BY
    number_of_categories DESC;
====================================================================================================================================================================================
====================================================================================================================================================================================

SELECT 
    o.customer_id,
    COUNT(DISTINCT p.category) AS number_of_categories
FROM orders_amz o
JOIN orderdetails od ON o.order_id = od.order_id
JOIN products_amz p ON od.product_id = p.product_id
GROUP BY o.customer_id
HAVING number_of_categories >= 2
ORDER BY number_of_categories DESC;
